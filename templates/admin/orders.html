{%extends 'admin/admin_base.html'%}
{% load static %}
{% block content %}
<style>

#footer{
      margin-top: 1rem;
      color: white;
    }
section{
    margin-top: 2rem;
}
svg{
    top:30px
}

@media screen and (max-width: 960px) {  
svg{
    top:-13rem
}
}

/* vars */
:root {
  --back: #eeeeee;
	--blue: #0082d2;
	--green: #33DDAA;
  --gray: #777777;
  --size: 200px;  
}


.tracking-wrapper {
	margin: 30px;
  padding: 0;
}
.tracking * {
	padding: 0;
	margin: 0;
}
.tracking {
	width: var(--size);
	max-width: 100%;
	position: relative;
}
.tracking .empty-bar {
	background: #ddd;
	position: absolute;
	width: 90%;
	height: 20%;
	top: 40%;
	margin-left: 5%;
}
.tracking .color-bar {
	background: var(--blue);
	position: absolute;
	height: 20%;
	top: 40%;
	margin-left: 5%;
	transition: all 0.5s;
	-webkit-transition: all 0.5s;
	-moz-transition: all 0.5s;
	-ms-transition: all 0.5s;
	-o-transition: all 0.5s;
}
.tracking ul {
	display: flex;
	justify-content: space-between;
	list-style: none;
}
.tracking ul > li {
	background: #ddd;
	text-align: center;
  border-radius: 50%;
	-webkit-border-radius: 50%;
	-moz-border-radius: 50%;
	-ms-border-radius: 50%;
	-o-border-radius: 50%;
	z-index: 1;
	background-size: 70%;
	background-repeat: no-repeat;
	background-position: center center;
	transition: all 0.5s;
	-webkit-transition: all 0.5s;
	-moz-transition: all 0.5s;
	-ms-transition: all 0.5s;
	-o-transition: all 0.5s;
	display: inline-block;
	position: relative;
	width: 10%;
}
.tracking ul > li .el {
	position: relative;
  margin-top: 100%;
}
.tracking ul > li .el i {
  position: absolute;
  bottom: 100%;
  left: 8%;
  margin-bottom: 12%;
  color: #fff;
  font-size: 100%;
  display: none;
}
.tracking ul > li .txt {
  color: #999;
	position: absolute;
	top: 120%;
	left: -75%;
	text-align: center;
	width: 250%;
	font-size: .75rem;
}
.tracking .progress-0 .color-bar { width: 00%; }
.tracking .progress-1 .color-bar { width: 15%; }
.tracking .progress-2 .color-bar { width: 30%; }
.tracking .progress-3 .color-bar { width: 45%; }
.tracking .progress-4 .color-bar { width: 60%; }
.tracking .progress-5 .color-bar { width: 75%; }
.tracking .progress-6 .color-bar { width: 90%; }
.tracking .progress-7 .color-bar { width: 90%; }

.tracking .progress-0 > ul > li.bullet-1,
.tracking .progress-1 > ul > li.bullet-1,
.tracking .progress-2 > ul > li.bullet-1,
.tracking .progress-3 > ul > li.bullet-1,
.tracking .progress-4 > ul > li.bullet-1,
.tracking .progress-5 > ul > li.bullet-1,
.tracking .progress-6 > ul > li.bullet-1,
.tracking .progress-7 > ul > li.bullet-1
{ background-color: var(--blue); }

.tracking .progress-2 > ul > li.bullet-2,
.tracking .progress-3 > ul > li.bullet-2,
.tracking .progress-4 > ul > li.bullet-2,
.tracking .progress-5 > ul > li.bullet-2,
.tracking .progress-6 > ul > li.bullet-2,
.tracking .progress-7 > ul > li.bullet-2
{ background-color: var(--blue); }

.tracking .progress-4 > ul > li.bullet-3,
.tracking .progress-5 > ul > li.bullet-3,
.tracking .progress-6 > ul > li.bullet-3,
.tracking .progress-7 > ul > li.bullet-3
{ background-color: var(--blue); }

.tracking .progress-6 > ul > li.bullet-4,
.tracking .progress-7 > ul > li.bullet-4
{ background-color: var(--blue); }

.tracking .progress-7 > ul > li.bullet-4
{ background-color: var(--green); }

.tracking .progress-1 > ul > li.bullet-1 .el i,
.tracking .progress-2 > ul > li.bullet-1 .el i,
.tracking .progress-3 > ul > li.bullet-1 .el i,
.tracking .progress-4 > ul > li.bullet-1 .el i,
.tracking .progress-5 > ul > li.bullet-1 .el i,
.tracking .progress-6 > ul > li.bullet-1 .el i,
.tracking .progress-7 > ul > li.bullet-1 .el i
{ display: block; }

.tracking .progress-3 > ul > li.bullet-2 .el i,
.tracking .progress-4 > ul > li.bullet-2 .el i,
.tracking .progress-5 > ul > li.bullet-2 .el i,
.tracking .progress-6 > ul > li.bullet-2 .el i,
.tracking .progress-7 > ul > li.bullet-2 .el i
{ display: block; }

.tracking .progress-5 > ul > li.bullet-3 .el i,
.tracking .progress-6 > ul > li.bullet-3 .el i,
.tracking .progress-7 > ul > li.bullet-3 .el i
{ display: block; }

.tracking .progress-7 > ul > li.bullet-4 .el i
{ display: block; }

.tracking .progress-1 > ul > li.bullet-1 .txt,
.tracking .progress-2 > ul > li.bullet-1 .txt,
.tracking .progress-3 > ul > li.bullet-1 .txt,
.tracking .progress-4 > ul > li.bullet-1 .txt,
.tracking .progress-5 > ul > li.bullet-1 .txt,
.tracking .progress-6 > ul > li.bullet-1 .txt,
.tracking .progress-7 > ul > li.bullet-1 .txt
{ color: var(--blue); }

.tracking .progress-3 > ul > li.bullet-2 .txt,
.tracking .progress-4 > ul > li.bullet-2 .txt,
.tracking .progress-5 > ul > li.bullet-2 .txt,
.tracking .progress-6 > ul > li.bullet-2 .txt,
.tracking .progress-7 > ul > li.bullet-2 .txt
{ color: var(--blue); }

.tracking .progress-5 > ul > li.bullet-3 .txt,
.tracking .progress-6 > ul > li.bullet-3 .txt,
.tracking .progress-7 > ul > li.bullet-3 .txt
{ color: var(--blue); }

.tracking .progress-7 > ul > li.bullet-4 .txt
{ color: var(--blue); }

/* demo */
.controls {
  margin: 90px 30px 30px;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: flex-start;
}
.controls > div {
  display: flex;
  justify-content: flex-start;
  align-items: space-between;
  margin: 0;
  padding: 0;
}
.controls p,
.controls button {
  border: 0;
  line-height: 20px;
  padding: 15px;
  font-size: 0.8rem;
  text-transform: uppercase;
}
.controls button {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 0 6px;
  background: var(--blue);
  color: #fff;
  border-radius: 50px;
  transition: all .3s;
}
.controls button:nth-child(1) {
  margin-left: 0;
}
.controls button i {
  font-size: 1rem;
  margin: 0 5px;
}
.controls button#prev { padding-right: 30px; }
.controls button#next { padding-left: 30px; }

.controls button:hover,
.controls button:focus {
  outline: none;
  background-color: var(--green);
}
#filter{
  margin-right: 100px;
}
#flt_div{
  text-align: right;
}
@media screen and (max-width: 960px) {  
  #filter{
  margin-right: 0px;
}
#flt_div{
  text-align: center;
}
}


</style>
<div class="row pt-3" style="background-color: black;">
  <div class="" style="font-size: 20px;font-weight: 600;color:#6C7293;">Orders List</div>
</div>
<section style="">
  
  
  <div class="container ">

    <div class="row">
      <div class="col-sm-12 mb-5" style="" id="flt_div">
        <a href="" data-toggle="modal" data-target="#flt_id" style="text-decoration: none;"><button class="btn btn-primary pl-4 pr-4 pb-2 pt-2" id="">Filter By OrderID</button></a>
  
        <a href="" data-toggle="modal" data-target="#flt_date" style="text-decoration: none;"><button class="btn btn-primary  pb-2 pt-2" id="filter">Filter by Date</button></a>
      </div>
    </div>
    {% if orders%}
    {%for i in orders%}
    
    <div class="row justify-content-center mb-3 outers">
      <div class="col-md-12 col-xl-10">
         
        <div class="card shadow-0 border rounded-3 outers">
          <div class="card-body">
            <div class="row">
              <div class="col-md-12 col-lg-2 col-xl-2 mb-4 mb-lg-0">
                <div class="bg-image hover-zoom ripple rounded ripple-surface" >
                  <a href="{%url 'order_details' i.id%}">
                  <img src="{{i.user.profile.url}}"
                  class="w-100"/>
                  </a>
                  <a href="#!">
                    <div class="hover-overlay">
                      <div class="mask" style="background-color: rgba(253, 253, 253, 0.15);"></div>
                    </div>
                  </a>
                </div>
              </div>
              <div class="col-md-6 col-lg-6 col-xl-6 mt-1 ">
                <h5 class="card-title">{{i.user.regno}}</h5>
                <h5 class="card-title">{{i.user.name}}</h5>
                <div class="d-flex flex-row">
                <div class="">
                    <span class="card-title">Order Number : {{i.regno}}</span><br>
                    <span class="card-title">Ph. No : {{i.user.number}}</span><br>
                    <span class="card-title">Address : {{i.user.addres}}</span><br>
                    <span class="card-title">Order Date : {{i.date}}</span><br>
                    <span class="card-title">Total Amount : â‚¹{{i.total_amount}}</span><br>
                </div>
                

                
                </div>
                
                
              </div>
              
              <div class="col-md-6 col-lg-4 col-xl-4 ">
                <div class="d-flex flex-row align-items-center mb-1">

                  <div class="row">
                    <div class="col-sm-12">
                        
                        <div class="tracking-wrapper">
                            <div class="tracking">
                              <div id="progress{{forloop.counter}}" class="progress-{{i.stage_count}}">
                                <div class="empty-bar"></div>
                                <div class="color-bar"></div>
                                <ul>
                                  <li class="bullet-1">
                                    <div class="el"><i class='bx bx-check'></i></div>
                                    <div class="txt">Order Processed</div>
                                  </li>
                                  <li class="bullet-2">
                                    <div class="el"><i class='bx bx-check'></i></div>
                                    <div class="txt">Order Shipped</div>
                                  </li>
                                  <li class="bullet-3">
                                    <div class="el"><i class='bx bx-check'></i></div>
                                    <div class="txt">Order En Route</div>
                                  </li>
                                  <li class="bullet-4">
                                    <div class="el"><i class='bx bx-check '></i></div>
                                    <div class="txt">Order Arrived</div>
                                  </li>
                                </ul>
                              </div>
                            </div>
                          </div>
                          
                          <div class="controls">
                            <div>
                              <button id="prev" onclick="prev('{{forloop.counter}}', '{{i.id}}')"><i class='bx bx-chevron-left'></i> Prev</button>
                              <button id="next" onclick="next('{{forloop.counter}}', '{{i.id}}')">Next <i class='bx bx-chevron-right'></i></button>
                            </div>
                            
                          </div>
                    </div>
                  </div>
                    
                </div>
                
                <div class="d-flex flex-column mt-4">
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {%endfor%}
    {%else%}
    <div class="row">
        <div class="col-sm-4 bg-dark p-5" style="text-align: center;margin: auto;">
            <h5>No Orders Found!</h5>
        </div>
    </div>
    {%endif%}
    
  </div>
</section>


<div class="rowmt-5 modal fade" id="flt_date">
  <div class="modal-dialog bd-example-modal-xl modal-dialog-centered" role="document" tabindex="-1" role="dialog"
    aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-content modal-xl" style="background-color: #191c24;">
      <div class="card ">
        <div class="card-body">
          <button type="button" class="close text-light" data-dismiss="modal" aria-label=""
            style="background-color: #191c24;border:none;float: right;font-size: 20px;">
            <span aria-hidden="true">&times;</span>
          </button>
          <div class="text-info" style="font-size: 20px;font-weight: 600;">Filter By Date</div>

          <form action="{% url 'filter_order'%}" method="POST" enctype="multipart/form-data">
            {% csrf_token %} 

            <div class="row mt-5">
              
              <div class="col-md-6 ">
                  <div>
                      <label for="">Start Date</label>
                  </div>
                  <div>
                  <input type="date" class="drop form-control ml-3 mt-2 text-light" name="str_dt" style="border:1px solid #6C7293 ;height:70px;"  >
                  </div>

    
              </div>
              <div class="col-md-6 ">
                  <div>
                      <label for=""> End Date</label>
                  </div>
                  <div>
                      <input type="date" name="end_dt" class="drop form-control ml-3 mt-2 text-light" style="border:1px solid #6C7293 ;height:70px;"  >
                  </div>

    
              </div>

            </div>

            <div class="row mt-4 ">
              <div class="col-md-12" style="text-align: center;">
                  
                      <button type="submit" name="submit" id="alert2" class="btn-primary Search" >Filter</button>
                  
              </div>
            </div>
            
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="rowmt-5 modal fade" id="flt_id">
  <div class="modal-dialog bd-example-modal-xl modal-dialog-centered" role="document" tabindex="-1" role="dialog"
    aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-content modal-xl" style="background-color: #191c24;">
      <div class="card ">
        <div class="card-body">
          <button type="button" class="close text-light" data-dismiss="modal" aria-label=""
            style="background-color: #191c24;border:none;float: right;font-size: 20px;">
            <span aria-hidden="true">&times;</span>
          </button>
          <div class="text-info" style="font-size: 20px;font-weight: 600;">Filter By OrderID</div>

          <form action="{% url 'filter_order_id'%}" method="POST" enctype="multipart/form-data">
            {% csrf_token %} 

            <div class="row mt-5">
              
              <div class="col-md-12 ">
                  <div>
                      <label for="">Order Id :</label>
                  </div>
                  <div>
                  <input type="text" class="drop form-control ml-3 mt-2 text-light" name="ord_id" style="border:1px solid #6C7293 ;height:70px;"  >
                  </div>

    
              </div>
              

            </div>

            <div class="row mt-4 ">
              <div class="col-md-12" style="text-align: center;">
                  
                      <button type="submit" name="submit" id="alert2" class="btn-primary Search" >Find</button>
                  
              </div>
            </div>
            
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<script>

function next(ids, id){
    console.log(ids)
    var trak = document.getElementById(`progress${ids}`);

    var cls = trak.className.split('-').pop();
    console.log(cls)
	cls > 6 ? cls = 0 : cls++;
    trak.className = 'progress-' + cls;

    $.ajax({
            type: "GET",
            url: "{% url 'change_order_status' %}",
            data: {
                ele : id,
                count:cls,
                
                
            },
            success:function(response){
                alert("Order Status Update Successfully")
            }});


}

function prev(ids,id){
    var trak = document.getElementById(`progress${ids}`);
    var cls = trak.className.split('-').pop();
	cls < 1 ? cls = 7 : cls--;
    trak.className = 'progress-' + cls;

    $.ajax({
            type: "GET",
            url: "{% url 'change_order_status' %}",
            data: {
                ele : id,
                count:cls,
                
            },
            success:function(response){
                 alert("Order Status Update Successfully")
            }});

}

</script>

  <script>
      
       function fieldset1_function(){
          document.getElementById('field2').style.display="none";
          document.getElementById('field1').style.display="block";

       }
       function fieldset2_function(){
          document.getElementById('field1').style.display="none";
          document.getElementById('field2').style.display="block";

       }
 
   </script> 


{% endblock %}